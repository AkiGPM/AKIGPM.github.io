<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.0/p5.js"></script>
  <style>
    body {
      display: flex;
      flex-direction: column;
      align-items: center;
      margin-top: 20px;
    }
  </style>
</head>
<body>
  <div id="baseImageInput">
    <label for="baseImageUpload">Upload Base Image:</label>
    <input type="file" id="baseImageUpload" accept="image/*">
  </div>

  <div id="watermarkInput">
    <label for="watermarkUpload">Upload Watermark:</label>
    <input type="file" id="watermarkUpload" accept="image/*">
  </div>

  <canvas id="myCanvas"></canvas>

  <script>
    let baseImage;
    let watermarkImage;

    function setup() {
      createCanvas(400, 400);
      background(255);

      // Listen for changes in the base image input
      document.getElementById('baseImageInput').addEventListener('change', handleBaseImageUpload);

      // Listen for changes in the watermark input
      document.getElementById('watermarkInput').addEventListener('change', handleWatermarkUpload);
    }

    function drawImages() {
      background(255);
      if (baseImage) {
        let aspectRatio = baseImage.width / baseImage.height;
        let canvasWidth = min(width, baseImage.width);
        let canvasHeight = min(height, baseImage.height);
        if (width / height > aspectRatio) {
          canvasWidth = height * aspectRatio;
        } else {
          canvasHeight = width / aspectRatio;
        }
        image(baseImage, 0, 0, canvasWidth, canvasHeight);
      }
      if (watermarkImage) {
        image(watermarkImage, 0, 0, width, height);
      }
    }

    function handleBaseImageUpload(event) {
      const file = event.target.files[0];
      if (file) {
        const reader = new FileReader();
        reader.onload = function(e) {
          baseImage = loadImage(e.target.result, drawImages);
        };
        reader.readAsDataURL(file);
      }
    }

    function handleWatermarkUpload(event) {
      const file = event.target.files[0];
      if (file) {
        const reader = new FileReader();
        reader.onload = function(e) {
          watermarkImage = loadImage(e.target.result, drawImages);
        };
        reader.readAsDataURL(file);
      }
    }

    function draw() {
      drawImages();
    }
  </script>
</body>
</html>
